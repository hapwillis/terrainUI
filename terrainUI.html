<html>
	<head>
		<meta charset=utf-8>
		<title>supportTest</title>
		<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
		<script src="three.js"></script>
		<script src="Detector.js"></script>
		<script>
		'use strict';
		if ( ! Detector.webgl ) Detector.addGetWebGLMessage();
		// Globally used THREE.js objects here
		var camera, scene, renderer, terrainVertexBuffer;

		init();

		animate();

		function init(){
			scene = new THREE.Scene();
			camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
			camera.position.y = 1;
			// callback for mouse movement (click + drag) performs rotations
			// callback for WS moves camera along camera.getWorldDirection
			// callback for AD moves camera along camera.getWorldDirection.cross(camera.up)

			terrainVertexBuffer = new THREE.PlaneBufferGeometry( 20, 20, 32 );
			var material = new THREE.MeshBasicMaterial( {color: 0xD3D3D3, side: THREE.DoubleSide} );
			var plane = new THREE.Mesh( terrainVertexBuffer, material );
			plane.lookAt(0.0, 1.0, 0.0);
			scene.add( plane );

			renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth, window.innerHeight );
			document.body.appendChild( renderer.domElement );
		}

		function subdividePlane(planeBuffer) {
			if (!planeBuffer.isBufferGeometry){return;}

			var vertPositions = planeBuffer.getAttribute('position').array;
			var vertColors = planeBuffer.getAttribute('color').array;
			var indices = planebuffer.getIndex().array;

			// insert subdivided vertices with splice

			planeBuffer.getAttribute('position').needsUpdate = true;
			planeBuffer.getAttribute('color').needsUpdate = true;
			planebuffer.getIndex().needsUpdate = true;
			planeBuffer.computeVertexNormals();
		}

		// opposite of subdividePlane
		function decimatePlane(planeBuffer) {
			if (!planeBuffer.isBufferGeometry){return;}

			var vertPositions = planeBuffer.getAttribute('position').array;
			var vertColors = planeBuffer.getAttribute('color').array;
			var indices = planebuffer.getIndex().array;

			// remove subdivided vertices

			planeBuffer.getAttribute('position').needsUpdate = true;
			planeBuffer.getAttribute('color').needsUpdate = true;
			planebuffer.getIndex().needsUpdate = true;
			planeBuffer.computeVertexNormals();
		}

		function animate() {
			requestAnimationFrame( animate );
			renderer.render( scene, camera );
		}

		function onWindowResize() {
			camera.aspect = window.innerWidth / window.innerHeight;
		  camera.updateProjectionMatrix();
		  renderer.setSize( window.innerWidth, window.innerHeight );
		}
		</script>
	</body>
</html>
